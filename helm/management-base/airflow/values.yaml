# Airflow - 환경 중립적 기본값
# 이 파일은 공통 기본값만 정의합니다.
# 환경별 설정은 k8s-dev-k3d/values/ 또는 k8s-eks/values/에서 오버라이드하세요.

airflow:
  defaultAirflowRepository: apache/airflow
  defaultAirflowTag: "2.9.0"
  defaultAirflowImagePullPolicy: IfNotPresent

  executor: CeleryExecutor

  postgresql:
    enabled: true
    auth:
      username: airflow
      password: ""  # 환경별로 오버라이드 필수
      database: airflow
    persistence:
      enabled: true
      size: 20Gi
      storageClassName: ""  # 환경별로 오버라이드
    primary:
      resources:
        requests:
          memory: "512Mi"
          cpu: "500m"
        limits:
          memory: "1Gi"
          cpu: "1000m"

  redis:
    enabled: true
    persistence:
      storageClassName: ""

  dags:
    persistence:
      enabled: true
      size: 5Gi
      storageClassName: ""
    gitSync:
      enabled: false

  logs:
    persistence:
      enabled: false

  webserver:
    replicas: 1
    service:
      type: ClusterIP
    resources:
      requests:
        memory: "512Mi"
        cpu: "500m"
      limits:
        memory: "1Gi"
        cpu: "1000m"

  scheduler:
    replicas: 1
    resources:
      requests:
        memory: "512Mi"
        cpu: "500m"
      limits:
        memory: "1Gi"
        cpu: "1000m"

  workers:
    replicas: 2
    resources:
      requests:
        memory: "512Mi"
        cpu: "500m"
      limits:
        memory: "1Gi"
        cpu: "1000m"

  flower:
    enabled: false

  triggerer:
    enabled: false

  env:
    - name: AIRFLOW__CORE__EXECUTOR
      value: CeleryExecutor
    - name: AIRFLOW__CORE__LOAD_EXAMPLES
      value: "false"
    - name: AIRFLOW__WEBSERVER__EXPOSE_CONFIG
      value: "true"
    - name: AIRFLOW__CORE__PARALLELISM
      value: "32"
    - name: AIRFLOW__CORE__DAG_CONCURRENCY
      value: "16"
    - name: AIRFLOW__CORE__MAX_ACTIVE_TASKS_PER_DAG
      value: "16"
    - name: AIRFLOW__LOGGING__LOGGING_LEVEL
      value: INFO
    - name: AIRFLOW__API__AUTH_BACKENDS
      value: airflow.api.auth.backend.basic_auth

  serviceAccount:
    create: true
    name: ""

  persistence:
    enabled: false

  ingress:
    enabled: false
