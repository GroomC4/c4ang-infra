# Store Service Helm Chart - 기본값
# 환경별 설정은 config/{env}/store-service.yaml에서 관리
# 참고: docs/GITOPS-HELM-ARGOCD-GUIDE.md

fullnameOverride: store-api

replicaCount: 2

image:
  repository: ""
  pullPolicy: IfNotPresent
  tag: ""

imagePullSecrets: []

service:
  type: ClusterIP
  port: 8081
  targetPort: 8081

resources:
  requests:
    memory: 512Mi
    cpu: 100m
  limits:
    memory: 1Gi
    cpu: 250m

autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

# 환경변수 - config/{env}/store-service.yaml에서 정의
config: {}

# 시크릿 - config/{env}/store-service.yaml에서 정의
secrets: {}

extraEnv: []

redis:
  enabled: false

istio:
  enabled: true
  pathPrefix: /api/v1/stores
  timeout: 30s
  retries:
    attempts: 3
    perTryTimeout: 10s
    retryOn: "5xx,reset,connect-failure,refused-stream"
  trafficPolicy:
    connectionPool:
      tcp:
        maxConnections: 100
      http:
        http1MaxPendingRequests: 50
        http2MaxRequests: 100
        maxRequestsPerConnection: 2
    outlierDetection:
      consecutive5xxErrors: 5
      interval: 10s
      baseEjectionTime: 30s
      maxEjectionPercent: 50
      minHealthPercent: 40
  gatewayAPI:
    enabled: true
    gatewayName: ecommerce-gateway
    gatewayNamespace: ecommerce
    hostnames:
      - api.c4ang.com

analysis:
  prometheusUrl: "http://prometheus.monitoring.svc.cluster.local:9090"
